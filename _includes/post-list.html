<!-- Post List Component -->
{% if posts %}
    {% assign filtered_posts = posts %}
{% else %}
    {% assign filtered_posts = site.posts %}
{% endif %}

{% if filter_by_category %}
    {% assign filtered_posts = filtered_posts | where_exp: "post", "post.categories contains filter_by_category" %}
{% elsif filter_by_tag %}
    {% assign filtered_posts = filtered_posts | where_exp: "post", "post.tags contains filter_by_tag" %}
{% endif %}

{% if filtered_posts.size > 0 %}
<!-- Handle limit (optional) -->
{% assign posts_to_show = filtered_posts %}
{% if limit %}
{% assign posts_to_show = filtered_posts | slice: 0, limit %}
{% endif %}

<ul class="space-y-4">
    {% for post in posts_to_show %}
    <li>
        <article
            class="flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4 p-5 bg-white rounded-lg hover:shadow-md hover:bg-gray-50 transition-all border-l-4 border-purple-600 shadow-sm border border-gray-100"
            itemscope itemtype="https://schema.org/BlogPosting">

            <div class="flex-1">
                <a href="{{ post.url | relative_url }}"
                    class="text-lg font-semibold text-gray-900 hover:text-purple-600 transition-colors"
                    itemprop="headline">
                    {{ post.title }}
                </a>

                <p class="text-gray-600 text-sm mt-2" itemprop="description">
                    {{ post.excerpt | strip_html | truncatewords: 25 }}
                </p>

                <div class="flex flex-wrap gap-4 mt-3 text-sm text-gray-400">
                    <time datetime="{{ post.date | date_to_xmlschema }}" class="text-gray-600 flex items-center gap-1"
                        itemprop="datePublished">
                        <i data-lucide="calendar" style="width: 14px; height: 14px;"></i>
                        {{ post.date | date: "%b %d, %Y" }}
                    </time>

                    {% if post.author %}
                    <span class="text-gray-600 flex items-center gap-1" itemprop="author" itemscope
                        itemtype="https://schema.org/Person">
                        <i data-lucide="user" style="width: 14px; height: 14px;"></i>
                        <span itemprop="name">{{ post.author }}</span>
                    </span>
                    {% endif %}

                    {% if post.reading_time %}
                    <span class="text-gray-600 flex items-center gap-1">
                        <i data-lucide="clock" style="width: 14px; height: 14px;"></i>
                        {{ post.reading_time }} min read
                    </span>
                    {% endif %}
                </div>

                {% if post.tags %}
                <div class="flex flex-wrap gap-2 mt-3">
                    {% for tag in post.tags limit:3 %}
                    <a href="{{ '/tags/' | relative_url }}{{ tag | slugify }}/"
                        class="inline-block bg-purple-100 text-purple-600 px-3 py-1 rounded-full text-xs font-medium hover:bg-purple-200 transition-colors"
                        itemprop="keywords">
                        {{ tag }}
                    </a>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
        </article>
    </li>
    {% endfor %}
</ul>
{% else %}
<!-- No posts message -->
<div class="text-center py-16">
    <i data-lucide="inbox" class="text-gray-400 mx-auto mb-4" style="width: 64px; height: 64px;"></i>
    {% if filter_by_category %}
    <p class="text-gray-600 text-lg">No posts in this category yet.</p>
    {% elsif filter_by_tag %}
    <p class="text-gray-600 text-lg">No posts with this tag yet.</p>
    {% else %}
    <p class="text-gray-600 text-lg">No posts yet. Check back soon!</p>
    {% endif %}
</div>
{% endif %}